################################################################################
# Autogenerated by build_tools/bazel_to_cmake/bazel_to_cmake.py from           #
# compiler/plugins/target/SA16/BUILD.bazel                                     #
#                                                                              #
# Use iree_cmake_extra_content from iree/build_defs.oss.bzl to add arbitrary   #
# CMake-only content.                                                          #
#                                                                              #
# To disable autogeneration for this file entirely, delete this header.        #
################################################################################

iree_compiler_register_plugin(
  PLUGIN_ID
    hal_target_sa16
  TARGET
    ::SA16
)

iree_cc_library(
  NAME
    SA16
  HDRS
    "SA16LibraryBuilder.h"
  SRCS
    "SA16Target.cpp"
    "SA16LibraryBuilder.cpp"
  DEPS
    ::SA16IRPasses
    ::SA16TargetOptions
    ::SA16LinkerTool
    ::SA16StaticLibraryGenerator
    IREESA16TargetDeps
    IREELinalgTransformDialect
    LLVMAnalysis
    LLVMBitReader
    LLVMBitWriter
    LLVMCore
    LLVMLinker
    LLVMSupport
    LLVMTargetParser
    MLIRArmNeonDialect
    MLIRArmSMEDialect
    MLIRArmSMEToLLVMIRTranslation
    MLIRArmSVEDialect
    MLIRArmSVEToLLVMIRTranslation
    MLIRBuiltinToLLVMIRTranslation
    MLIRIR
    MLIRLLVMDialect
    MLIRLLVMToLLVMIRTranslation
    MLIRPDLDialect
    MLIRPDLInterpDialect
    MLIRSupport
    MLIRTargetLLVMIRExport
    MLIRTransformDialect
    iree::compiler::Codegen::Common
    iree::compiler::Codegen::Dialect::CPU::IR::IREECPUDialect
    iree::compiler::Codegen::Dialect::Codegen::IR::IREECodegenDialect
    iree::compiler::Codegen::Dialect::VectorExt::IR::IREEVectorExtDialect
    iree::compiler::Codegen::LLVMCPU
    iree::compiler::Codegen::Utils
    iree::compiler::Dialect::Encoding::IR
    iree::compiler::Dialect::HAL::Target
    iree::compiler::Dialect::HAL::Target::Devices
    iree::compiler::Dialect::HAL::Utils::LLVMLinkerUtils
    iree::compiler::Dialect::LinalgExt::IR
    iree::compiler::Dialect::Util::IR
    iree::compiler::PluginAPI
    iree::compiler::Utils
  PUBLIC
)

iree_cc_library(
  NAME
    SA16IRPasses
  HDRS
    "SA16IRPasses.h"
  SRCS
    "SA16IRPasses.cpp"
  DEPS
    ::SA16TargetOptions
    LLVMAnalysis
    LLVMCore
    LLVMInstrumentation
    LLVMMC
    LLVMPasses
    LLVMSupport
    LLVMTarget
    LLVMTargetParser
    MLIRSupport
  PUBLIC
)

iree_cc_library(
  NAME
    SA16ResolveCPUAndCPUFeatures
  HDRS
    "SA16ResolveCPUAndCPUFeatures.h"
  SRCS
    "SA16ResolveCPUAndCPUFeatures.cpp"
  DEPS
    LLVMSupport
    LLVMTarget
    LLVMTargetParser
  PUBLIC
)

iree_cc_library(
  NAME
    SA16TargetOptions
  HDRS
    "SA16TargetOptions.h"
  SRCS
    "SA16TargetOptions.cpp"
  DEPS
    ::SA16ResolveCPUAndCPUFeatures
    LLVMAnalysis
    LLVMCore
    LLVMMC
    LLVMPasses
    LLVMSupport
    LLVMTarget
    LLVMTargetParser
    MLIRIR
    iree::compiler::Codegen::LLVMCPU
    iree::compiler::Utils
  PUBLIC
)

add_subdirectory(internal)

iree_cc_library(
  NAME
    SA16LinkerTool
  HDRS
    "SA16LinkerTool.h"
  SRCS
    "SA16LinkerTool.cpp"
  DEPS
    ::SA16TargetOptions
    LLVMCore
    LLVMSupport
    LLVMTargetParser
    MLIRSupport
    iree::compiler::Utils
    # Note: circular dependency is ok here.
    iree::compiler::plugins::target::SA16::internal::SA16LinkerTools_internal
  PUBLIC
)

iree_cc_library(
  NAME
    SA16LinkerTool_hdrs
  HDRS
    "SA16LinkerTool.h"
  DEPS
    ::SA16TargetOptions
    LLVMCore
    LLVMSupport
    LLVMTargetParser
    MLIRSupport
  PUBLIC
)

iree_cc_library(
  NAME
    SA16StaticLibraryGenerator
  HDRS
    "SA16StaticLibraryGenerator.h"
  SRCS
    "SA16StaticLibraryGenerator.cpp"
  DEPS
    LLVMSupport
  PUBLIC
)

### BAZEL_TO_CMAKE_PRESERVES_ALL_CONTENT_BELOW_THIS_LINE ###

add_library(IREESA16TargetDeps INTERFACE)

function(_add_optional_llvm_target_deps target)
  # Key off of the CodeGen target and then include the rest.
  # Note that for LLVM DYLIB builds, we just key off of the presence of the
  # static CodeGen target and iree_redirect_llvm_dylib_deps will replace it
  # with the dylib accordingly (it is just a check to see if we have compiled in
  # support for the target).
  if(TARGET "LLVM${target}CodeGen")
    set(_target_deps
      "LLVM${target}AsmParser"
      "LLVM${target}CodeGen"
      "LLVM${target}Desc"
      "LLVM${target}Info"
    )
    iree_redirect_llvm_dylib_deps(_target_deps)
    target_link_libraries(IREESA16TargetDeps INTERFACE ${_target_deps})
  endif()
endfunction()

# This is just the CPU backends that we hard-link to. Single-target backends
# like CUDA and ROCM bring their dependencies explicitly.
# TODO: More archaeology and tieing this to explicit top-level configuration
# of backends.
_add_optional_llvm_target_deps(AArch64)
_add_optional_llvm_target_deps(ARM)
_add_optional_llvm_target_deps(RISCV)
_add_optional_llvm_target_deps(WebAssembly)
_add_optional_llvm_target_deps(X86)
